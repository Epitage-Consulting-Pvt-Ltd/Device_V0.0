# -*- coding: utf-8 -*-
"""verifyPunch.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1WAAI4MyamDjr9AFrD1vXwGxdSUOEgXjb
"""

import sqlite3
import datetime


# Connect to the database
conn = sqlite3.connect('localdb.db')
curs = conn.cursor()
print ("Opened database successfully");

curs.execute('''CREATE TABLE IF NOT EXISTS checkin(
                  emp_id INTEGER,
                  check_in TIMESTAMP,
                  FOREIGN KEY (emp_id)
                  REFERENCES employees(emp_id))''')

check_in = datetime.datetime.now()
curs.execute('''INSERT INTO checkin VALUES(?,?)''',(emp_id,check_in))

curs.execute('''CREATE TABLE id (
  emp_id INTEGER,
  rf_id INTEGER,
  fingerprint_tag INTEGER,
  face_id INTEGER,
  FOREIGN KEY(emp_id)
  REFERENCES employees(emp_id)

)''')

curs.execute('''INSERT INTO id VALUES(1,'9e:cd:8b:af:02','123','234')''')

curs.execute('''CREATE TABLE  fingerprinttag (
                 emp_id INTEGER,
                 fingerprint_tag INTEGER,
                 FOREIGN KEY (emp_id)
                 REFERENCES employees(emp_id)
             )''')

import csv

# open the file
file_path='/content/finger.csv'
with open(file_path, 'r') as csvfile:
    # create the object of csv.reader()
    csv_file_reader = csv.reader(csvfile, delimiter=',')
    for row in csv_file_reader:
        
        for i in range(len(row)):
            # assign each field its value
            emp_id=row[0]
            fingerprint_tag=row[1]
            
            InsertQuery=(f"INSERT INTO fingerprinttag VALUES ('{emp_id}','{fingerprint_tag}')")
        # 6. Execute query
        curs.execute(InsertQuery)

"""![image.png](data:image/png;base64,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)"""

curs.execute("DELETE FROM fingerprinttag")

curs.execute("SELECT * FROM fingerprinttag")
curs.fetchall()

def check_in(id_type, id_value):
    # Query the database for the user with the matching identification
    if id_type == 'fingerprint_tag':
        curs.execute("SELECT emp_id FROM fingerprinttag WHERE fingerprint_tag=?", (id_value,))
    elif id_type == 'rf_id':
        curs.execute("SELECT emp_id FROM rfid WHERE rf_id=?", (id_value,))
    elif id_type == 'face_id':
        curs.execute("SELECT emp_id FROM faceid WHERE face_id=?", (id_value,))
    
    # Get the result of the query
    user_id = curs.fetchone()
    
    # Insert the result into the checkin table
    if user_id is not None:
        checkin_time = datetime.datetime.now()
        curs.execute("INSERT INTO checkin (emp_id, check_in) VALUES (?, ?)", (user_id[0], checkin_time))
        return True
    else:
        return False

check_in('fingerprint_tag','929857')

curs.execute("SELECT * FROM checkin")
 curs.fetchall()

curs.execute("SELECT * FROM fingerprinttag WHERE fingerprint_tag='936744'")
print(curs.fetchone())